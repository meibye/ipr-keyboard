# ipr-keyboard Services

Service reference aligned to repository implementation (audited 2026-02-15).

## Primary Services

| Service | Unit Source | Installed By | Purpose |
|---|---|---|---|
| `ipr_keyboard.service` | generated by `scripts/service/svc_install_systemd.sh` | `scripts/service/svc_install_systemd.sh` | Runs `python -m ipr_keyboard.main` as app user |
| `bt_hid_agent_unified.service` | `scripts/service/svc/bt_hid_agent_unified.service` | `scripts/service/svc_install_bt_gatt_hid.sh` | BlueZ Agent1 pairing/authorization service |
| `bt_hid_ble.service` | `scripts/service/svc/bt_hid_ble.service` | `scripts/service/svc_install_bt_gatt_hid.sh` | BLE HID over GATT daemon |
| `ipr-provision.service` | `scripts/headless/ipr-provision.service` | `provision/04_enable_services.sh` | Headless Wi-Fi hotspot provisioning |

## Executables Installed by Service Scripts

| Installed Path | Source |
|---|---|
| `/usr/local/bin/bt_hid_agent_unified.py` | `scripts/service/bin/bt_hid_agent_unified.py` |
| `/usr/local/bin/bt_hid_ble_daemon.py` | `scripts/service/bin/bt_hid_ble_daemon.py` |
| `/usr/local/bin/bt_kb_send` | `scripts/ble/bt_kb_send.sh` via `scripts/ble/ble_install_helper.sh` |

## Install Sequence Used by Provisioning

`provision/04_enable_services.sh` executes:

1. `scripts/service/svc_install_bt_gatt_hid.sh`
2. `scripts/ble/ble_install_helper.sh`
3. `scripts/service/svc_install_systemd.sh`
4. `scripts/ble/ble_setup_extras.sh`
5. `scripts/service/svc_enable_services.sh`
6. installs `ipr-provision.service`

## Status/Control Scripts

- `scripts/service/svc_enable_services.sh`
- `scripts/service/svc_disable_services.sh`
- `scripts/service/svc_status_services.sh`
- `scripts/service/svc_tail_all_logs.sh`
- `scripts/service/svc_status_monitor.py`

## Legacy/Drift Signals

The following names appear in some scripts/docs but are **not shipped as service units in this repo state**:
- `bt_hid_uinput.service`
- `ipr_backend_manager.service`
- `bt_hid_daemon.service`

Treat those references as legacy until corresponding units are reintroduced.
