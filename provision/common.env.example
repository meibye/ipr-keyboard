# Common settings for both RPis - IPR Keyboard Project
# Copy this file to /opt/ipr_common.env on each device and edit device-specific values
#
# Usage:
#   sudo cp provision/common.env.example provision/common.env
#   nano provision/common.env  # Edit device-specific values
#   sudo cp provision/common.env /opt/ipr_common.env
#
# IMPORTANT:
#   Do NOT put inline comments on the same line as a value.
#   Example of BAD line (systemd may treat comment as part of value):
#     BT_DEVICE_NAME="IPR Keyboard (Dev)"  # comment
#   Put comments on their own lines instead.

# ============================================
# Repository Configuration
# ============================================
REPO_URL="https://github.com/meibye/ipr-keyboard.git"
REPO_DIR="/home/meibye/dev/ipr-keyboard"
APP_USER="meibye"
APP_GROUP="meibye"

# ============================================
# Git Identity (used for commits/pushes)
# ============================================
GIT_USER_NAME="Michael Eibye"
GIT_USER_EMAIL="michael@eibye.name"

# Pin to specific branch/tag for reproducibility
# Use "main" for latest, or a tag like "v1.0.0"
GIT_REF="main"

Merge strategy
#   "true"  -> rebase
#   "false" -> merge
GIT_REBASE="true"

# ============================================
# Copilot/MCP Debug Tooling (optional)
#
# Used by optional provisioning step(s) and by dbg_* tooling installation.
# Safe to keep set even if you do not use MCP.
# ============================================

# Dedicated diagnostics user on the Pi for Copilot/MCP SSH sessions
COPILOT_USER="copilotdiag"
COPILOT_GROUP="copilotdiag"

# Separate automation clone owned by COPILOT_USER (safe to reset --hard)
# This is the repo directory dbg_deploy.sh targets when using the “separate clone” model
COPILOT_REPO_DIR="/home/copilotdiag/ipr-keyboard"

# Git ref to use in the automation clone (typically same as GIT_REF)
COPILOT_GIT_REF="main"

# Root folder used by dbg_* scripts for pairing captures and bond wipe logs
DBG_LOG_ROOT="/var/log/ipr"

# Service(s) that dbg_* scripts should interact with
# bt_hid_ble.service is present in your repo under scripts/service/svc/
DBG_BLE_SERVICE_UNIT="bt_hid_ble.service"
DBG_AGENT_SERVICE_UNIT="bt_hid_agent_unified.service"

# ============================================
# Device-Specific Configuration
# ============================================
# IMPORTANT: Edit these values per device

# Device type: "dev" or "target"
# Change to "target" for RPi Zero 2 W
DEVICE_TYPE="dev"

# Hostname (set during provisioning)
# RPi 4: ipr-dev-pi4
# RPi Zero: ipr-target-zero2
HOSTNAME="ipr-dev-pi4"

# ============================================
# Application Configuration
# ============================================
APP_VENV_DIR="/home/meibye/dev/ipr-keyboard/.venv"
APP_ENTRY="src/ipr_keyboard/main.py"
SERVICE_NAME="ipr_keyboard"

# ============================================
# Bluetooth Configuration
#
# How Windows use BT_DEVICE_NAME and BT_MODEL
#
#    | Phase       | Field               | Used for           |
#    | ----------- | ------------------- | ------------------ |
#    | Discovery   | `BT_DEVICE_NAME`    | Device list entry  |
#    | Pairing     | `BT_DEVICE_NAME`    | User confirmation  |
#    | Enumeration | `BT_MODEL`          | Device metadata    |
#    | Caching     | `BT_MODEL` + PnP ID | Identity stability |
#    | Debug       | `BT_MODEL`          | Logs / properties  |
#
# BT_DEVICE_NAME → What humans see
# BT_MODEL → What the OS recognizes
#
# ============================================
BT_HCI="hci0"
# Backend: "ble" or "uinput" (BLE HID over GATT recommended)
BT_BACKEND="ble"

# Debugging
#   BT_AGENT_DEBUG="1"   -> verbose agent logs (otherwise quiet)
#   BT_BLE_DEBUG="1"     -> verbose BLE daemon logs (otherwise concise)
BT_AGENT_DEBUG="0"
BT_BLE_DEBUG="0"

# Bluetooth device name
# This is the name shown in BLE advertising (and also used for PRETTY_HOSTNAME)
# RPi 4: "IPR Keyboard (Dev)"
# RPi Zero: "IPR Keyboard"
BT_DEVICE_NAME="IPR Keyboard (Dev)"

# Pairing UX:
# Default (recommended): BLE-only. Prevents Windows from showing two devices.
# - 0: do NOT force classic discoverable (BR/EDR inquiry scan)
# - 1: enable classic discoverable (only if you intentionally use classic/uinput backend)
BT_ENABLE_CLASSIC_DISCOVERABLE="0"

# Controller mode in /etc/bluetooth/main.conf:
# - le   : BLE-only (recommended for BLE HID over GATT)
# - dual : BLE + BR/EDR (use only if you need classic/uinput backend)
BT_CONTROLLER_MODE="le"

# USB Vendor ID reported via BLE Device Information Service (PnP ID / UUID 2A50). Hex (0x####).
BT_USB_VID="0x1234"

# USB Product ID reported via BLE Device Information Service (PnP ID / UUID 2A50). Hex (0x####).
BT_USB_PID="0x5678"

# Device/firmware version reported via BLE Device Information Service (PnP ID / UUID 2A50). Hex (0x####).
BT_USB_VER="0x0100"

# Manufacturer name reported via BLE Device Information Service (UUID 2A29).
BT_MANUFACTURER="IPR"

# Model name/number reported via BLE Device Information Service (UUID 2A24).
BT_MODEL="IPR Keyboard"

# ============================================
# Network Configuration (for headless provisioning)
# ============================================
# Hotspot SSID prefix (actual SSID will be prefix-XXXX)
AP_SSID_PREFIX="ipr-setup"

# USB OTG static IP for Pi Zero 2 W
USB_OTG_IP="192.168.7.1/24"
